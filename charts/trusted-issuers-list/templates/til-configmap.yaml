apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ printf "%s-cm" (include "til.fullname" .) }}
  namespace: {{ $.Release.Namespace | quote }}
  labels:
    {{- include "til.labels" . | nindent 4 }}
data:
  application.yaml: |
    {{- $dbConfig := include "til.app.config" . | fromYaml }}
    {{- $config := mergeOverwrite $dbConfig .Values.config }}
    {{- toYaml $config | nindent 4 }}